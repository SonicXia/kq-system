<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<#include "../common/head.htm">
<body class="easyui-layout">
    <div data-options="region:'north',title:'个人考勤系统',split:true" style="height:100px;">
        <img src="/skin/logo.jpg" alt="个人考勤系统" style="width: 160px; height: 48px;">
        <div style="float: right;">
            <a id="eazyui-book" href="#" class="easyui-linkbutton" data-options="iconCls:'icon-tip'">通讯录</a>
            <a id="eazyui-quit" href="#" class="easyui-linkbutton" data-options="iconCls:'icon-cancel'">退出</a>
        </div>
    </div>
    <div data-options="region:'east',iconCls:'icon-reload',title:'小工具',split:true" style="width:150px;">
        <div class="easyui-calendar" style="width:150px;height:150px;"></div>
    </div>
    <div data-options="region:'west',title:'系统菜单',split:true" style="width:200px;">
        <div id="leftmenu" class="easyui-accordion" data-options="fit:true">
            <div title="个人考勤系统" data-options="iconCls:'icon-save,selected:true'" style="overflow:auto;padding:10px;">
                <ul id="easyuitree"></ul>
            </div>
        </div>

    </div>
    <div data-options="region:'center'" style="padding:5px;">
        <div id="center_tabs" class="easyui-tabs" data-options="fit:true">
            <div title="首页" style="padding:20px;">
                欢迎您,${(kqs_login_user.cname)!}的到来
            </div>
        </div>
    </div>
    <div id="erp_book">
        <ul id="book_tree"></ul>
    </div>
    <div data-options="region:'south',title:'© 个人考勤记录系统(lionxxw.org)',split:true" style="height:30px;"></div>
    <script type="text/javascript">
        $(function () {
            _base.init.pageUI();
            _base.init.bindEvent();
            $.messager.show({
                title:'我的消息',
                msg:'欢迎您,${(kqs_login_user.cname)!}<br/>上次登录时间：${(kqs_login_user.lastLoginTime?string("yyyy-MM-dd HH:mm:ss"))!}<br/>上次登录IP：${(kqs_login_user.lastLoginIp)!}',
                timeout:5000,
                width:350,
                height:200,
                showType:'slide'
            });
        });

        var _base = {
            init:{
                // 初始化界面
                pageUI:function(){
                    $("#easyuitree").tree({
                        url: "/data/menu.json",
                        dnd:true, // 是否启动拖拽功能
                        animate:true, // 是否显示展开/折叠动画
                        checkbox:true,// 是否在每一个节点上显示复选框
                        lines:true, // 是否显示树控件上的虚线
                        onClick:function(node){
                            console.log(node);
                            // $("#easyuitree").tree("getChildren",node)
                            var children = node.children; // 获取子节点
//                            console.log(children);

                            var tabs = $('#center_tabs').tabs("getTab", node.text);
                            //console.info(tabs);
                            if (tabs){
                                // 切换到指定面板
                                $('#center_tabs').tabs("select", node.text);
                            }else{
                                var content = '<iframe scrolling="auto" frameborder="0"  src="/WEB-INF/view/kqs/overtime/base_6.html" style="width:100%;height:100%;"></iframe>';
                                // 添加面板
                                $('#center_tabs').tabs('add',{
                                    title:node.text,
                                    //content:'Tab Body',
                                    content:content,
                                    closable:true
                                });
                            }
                        }
                    });
                },
                // 初始化需绑定的按钮
                bindEvent:function(){
                    $("#eazyui-book").click(function () {
                        $("#book_tree").tree({
                            url: "treedata.json",
                            dnd:true, // 是否启动拖拽功能
                            animate:true, // 是否显示展开/折叠动画
                            checkbox:true,// 是否在每一个节点上显示复选框
                            lines:true, // 是否显示树控件上的虚线
                            onClick:function(node){
                                console.log(node);
                                // $("#easyuitree").tree("getChildren",node)
                                var children = node.children; // 获取子节点
                                console.log(children);
                            }
                        });
                        $("#erp_book").window({
                            title:"通讯录",
                            height:300,
                            width:200
                        })
                    });
                    $("#eazyui-quit").click(function(){
                        $.messager.confirm('确认','您确认想要退出吗?',function(r){
                            if (r){
                                $.messager.alert('操作提示', "退出成功!", 'info',function(){
                                    window.location.href = '/logout.do'
                                });
                            }
                        });
                    });
                }
            }
        }
    </script>
</body>
</html>